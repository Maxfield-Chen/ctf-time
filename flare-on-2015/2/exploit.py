import angr, simuvex

start = 0x401084
end   = 0x40106b
avoid = 0x401072

p = angr.Project("./very_success", load_options={'auto_load_libs': False})

s = p.factory.blank_state(addr=start, remove_options={simuvex.o.LAZY_SOLVES})

# set up the arguments on the stack
s.mem[s.regs.esp+8:].dword = 0x1
s.mem[s.regs.esp+4:].dword = 0x4010e4
s.mem[s.regs.esp:].dword = 0x401064

s.mem[0x1:] = s.se.BVS("ans", 8*45)

path = p.factory.path(state=s)

explorer = p.surveyors.Explorer(start=path, find=(end,), avoid=(avoid,), enable_veritesting=True)
explorer.run()

if explorer.found:
    result = explorer.found[0].state
    print result.se.any_str(result.memory.load(0x1, 45)).strip('\0')
else:
    print "No Sol"
