import angr

start = 0x4028d9
end = 0x402964
avoid = 0x402941

p = angr.Project("./baby-re", load_options={'auto_load_libs': False})

state = p.factory.blank_state(addr=start)

"""
for i in xrange(0,13):
    state.stack_push(angr.claripy.BVS("foo", 8*4))
"""

path = p.factory.path(state=state)

explorer = p.surveyors.Explorer(start=path, find=(end,), avoid=(avoid,), enable_veritesting=True)
explorer.run()

if explorer.found:
    result = explorer.found[0]
    print result.state.posix.dumps(1)    
else:
    print "No Sol"
